{% extends "base.html.twig" %}

{% block title %}Albums{% endblock %}

{% block body %}
    <main id="container" class="cards">
        <h2>Liste des albums</h2>
        <div class="modal-container">
            <div class="overlay modal-trigger"></div>
            <div class="modal-content">
            </div>
        </div>
        <ul>
            {% for album in albums %}
                <li data-image-url="{{ asset('imgs/' ~ album.media.url) }}" data-image-alt="{{ album.media.alt }}">
                    <article>
                        <h3>{{album.getTitle()}}</h3>
                        <p>{{album.year}}</p>
                        {% if app.user.userIdentifier is defined %}
                            {% set currentRoute = app.request.attributes.get('_route') %}
                            <img src="{{ asset('imgs/img_formats.png')}}" class="image_collection modal-trigger" alt="collection" title="Choisir un format" data-target="album{{loop.index}}" >
                            <article class="formats album{{loop.index}}">
                                <h4>Liste des formats pour l'album {{album.getTitle()}}</h4>
                                {% for format in album.formats %}
                                    <p>
                                    {{format.libelle}}
                                    <a href="{{ path('add_collection', {idAlbum: album.id, idUser: app.user.id, returnUrl: currentRoute, idFormat: format.id}) }}">
                                        <img src="{{ asset('imgs/collection.gif')}}" alt="Ajouter à la collection" title="Ajouter à la collection" class="pictures" >
                                    </a>
                                    <a href="{{ path('add_search', {idAlbum: album.id, idUser: app.user.id, returnUrl: currentRoute, idFormat: format.id}) }}">
                                        <img src="{{ asset('imgs/search.gif')}}" alt="Ajouter aux recherches" class="pictures" title="Ajouter aux recherches"  >
                                    </a>
                                    </p>
                                {% endfor %}
                            </article>
                        {% endif %}
                        <p><a href="{{ path('album', {idAlbum: album.id}) }}" class="link">Plus</a>            
                    </article>
                </li>
            {% endfor %}
        </ul>
    </main>
{% endblock %}